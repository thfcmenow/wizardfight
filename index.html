<!DOCTYPE html>
<!-- 
Standard Game Music: Bensound.com
License code: AODQ6MSYKZKTL1LB 
Action Game Music:
Noise by Alex-Productions | https://onsound.eu/
Music promoted by https://www.chosic.com/free-music/all/
Creative Commons CC BY 3.0
https://creativecommons.org/licenses/by/3.0/
-->
<html>
<head>
    <title>Phaser Grid Game - Magical Edition</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --bg-color: #0a0a1a;
            --wizard-left: #4a90e2;
            --wizard-right: #e74c3c;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            /*background-color: var(--bg-color);*/
            font-family: 'minecraft', sans-serif;
        }

        /* --- THE BACKGROUND STAGE --- */
        #game-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: radial-gradient(circle at center, #1b2735 0%, #090a0f 100%);
            overflow: hidden;
        }

        /* Parallax Stars */
        .stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 200%;
            height: 200%;
            background: transparent;
        }

        .stars-small {
            width: 1px;
            height: 1px;
            background: transparent;
            box-shadow: 454px 124px #FFF , 123px 543px #FFF, 876px 12px #FFF, 1234px 876px #FFF, 543px 234px #FFF, 987px 543px #FFF, 123px 987px #FFF, 654px 321px #FFF;
            animation: moveStars 100s linear infinite;
        }

        .stars-med {
            width: 2px;
            height: 2px;
            box-shadow: 234px 543px #FFF, 765px 123px #FFF, 432px 876px #FFF, 987px 234px #FFF, 123px 432px #FFF;
            animation: moveStars 150s linear infinite;
            opacity: 0.5;
        }

        @keyframes moveStars {
            from { transform: translateY(0); }
            to { transform: translateY(-1000px); }
        }

        /* Animated Embers */
        .ember {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 200, 50, 0.4);
            border-radius: 50%;
            filter: blur(1px);
            animation: float 20s infinite linear;
        }

        @keyframes float {
            0% { transform: translateY(100vh) translateX(0); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateY(-10vh) translateX(100px); opacity: 0; }
        }

        /* 8-Bit Wizards in the Margins */
        .wizard-container {
            position: absolute;
            bottom: 20px;
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 5;
            pointer-events: none; /* Don't block clicks */
        }

        .wizard-left { left: 5%; }
        .wizard-right { right: 5%; transform: scaleX(-1); }

        .wizard-sprite {
            width: 64px;
            height: 64px;
            image-rendering: pixelated;
            animation: idle 2s infinite ease-in-out;
        }

        @keyframes idle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Spell Cast Animation */
        .spell {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            z-index: 1;
            pointer-events: none;
        }

        /* --- THE ACTUAL GAME CANVAS --- */
        /* We target the canvas generated by Phaser specifically */
        canvas {
            position: relative;
            z-index: 100 !important; /* Ensure it is above everything else */
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
            border: 4px solid #333;
            max-width: 100vw;
            max-height: 100vh;
        }

        /* This container helps center the canvas */
        #game-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            pointer-events: none; /* Container is passthrough */
        }

        /* Make sure the canvas itself still receives clicks */
        #game-container canvas {
            pointer-events: auto;
        }

        @font-face {
            font-family: minecraft;
            src: local('minecraft'), url(fonts/minecraft.ttf) format('truetype');
        }
        @font-face {
            font-family: ponari;
            src: local('ponari'), url(fonts/ponari.ttf) format('truetype');
        }
    </style>
    
    <script>
        document.fonts.load('10pt "minecraft"');
        document.fonts.load('10pt "ponari"');
    </script>
    <script src="./engine/phaser.min.js"></script>
</head>
<body>

    <div id="game-background">
        <!-- Parallax layers -->
        <div class="stars stars-small"></div>
        <div class="stars stars-med"></div>
        
        <!-- Animated 8-bit Wizards -->
        <div class="wizard-container wizard-left">
            <svg class="wizard-sprite" viewBox="0 0 16 16" fill="var(--wizard-left)">
                <rect x="6" y="2" width="4" height="4" />
                <rect x="5" y="6" width="6" height="8" />
                <rect x="4" y="10" width="2" height="4" />
                <rect x="11" y="4" width="1" height="10" fill="#8B4513" />
                <rect x="10" y="3" width="3" height="2" fill="#FFD700" />
            </svg>
        </div>

        <div class="wizard-container wizard-right">
            <svg class="wizard-sprite" viewBox="0 0 16 16" fill="var(--wizard-right)">
                <rect x="6" y="2" width="4" height="4" />
                <rect x="5" y="6" width="6" height="8" />
                <rect x="4" y="10" width="2" height="4" />
                <rect x="11" y="4" width="1" height="10" fill="#8B4513" />
                <rect x="10" y="3" width="3" height="2" fill="#00ffff" />
            </svg>
        </div>
    </div>

    <!-- This ID is commonly used as a parent for Phaser. 
         If your game.js uses a parent config, it will dock here. -->
    <div id="game-container"></div>

    <!-- Moving the script to the end ensures the container is ready -->
    <script type="module" src="./js/game.js"></script> 

    <script>
        // Visual polish: Create background particles
        const bg = document.getElementById('game-background');
        for (let i = 0; i < 20; i++) {
            const ember = document.createElement('div');
            ember.className = 'ember';
            ember.style.left = Math.random() * 100 + 'vw';
            ember.style.animationDelay = (Math.random() * 20) + 's';
            ember.style.opacity = Math.random();
            bg.appendChild(ember);
        }

        // Spell casting effect in the background
        setInterval(() => {
            const isLeft = Math.random() > 0.5;
            const spell = document.createElement('div');
            spell.className = 'spell';
            spell.style.backgroundColor = isLeft ? 'var(--wizard-left)' : 'var(--wizard-right)';
            spell.style.boxShadow = `0 0 15px ${spell.style.backgroundColor}`;
            spell.style.top = (40 + Math.random() * 20) + '%';
            spell.style.left = isLeft ? '10%' : '90%';
            
            bg.appendChild(spell);

            const animation = spell.animate([
                { left: isLeft ? '10%' : '90%', opacity: 1 },
                { left: isLeft ? '100%' : '0%', opacity: 0 }
            ], {
                duration: 2500 + Math.random() * 1000,
                easing: 'ease-in'
            });

            animation.onfinish = () => spell.remove();
        }, 5000);
    </script>
</body>
</html>